<div class="invitation-container" (click)="intentarReproducirMusica()">
  <audio #audioPlayer loop preload="auto">
    <source src="assets/audio/musica.mp3" type="audio/mpeg">
  </audio>
  
  <button class="music-control" (click)="toggleMusic(); $event.stopPropagation()" [title]="musicPlaying ? 'Pausar mÃºsica' : 'Reproducir mÃºsica'">
    {{ musicPlaying ? 'ğŸ”Š' : 'ğŸ”‡' }}
  </button>

  <div class="envelope-container" *ngIf="!sobreAbierto">
    <div class="flores-fondo">
      <div class="flor-fondo flor-1">ğŸŒ¸</div>
      <div class="flor-fondo flor-2">ğŸŒº</div>
      <div class="flor-fondo flor-3">ğŸŒ¸</div>
      <div class="flor-fondo flor-4">ğŸŒº</div>
      <div class="flor-fondo flor-5">ğŸŒ¸</div>
      <div class="flor-fondo flor-6">ğŸŒº</div>
      <div class="flor-fondo flor-7">ğŸŒ¸</div>
      <div class="flor-fondo flor-8">ğŸŒº</div>
    </div>
    
    <div class="envelope-scene">
      
      <div class="sobre-rosa" (click)="abrirSobre()">
        
        <div class="carta-invitacion">
          <div class="flor-decorativa">ğŸŒ¸</div>
          <h2 class="titulo-bautizo">Bautizo de</h2>
          <h1 class="nombre-nina">Arianita</h1>
          <div class="flores-pequeÃ±as">âœ¿ â€ âœ¿</div>
        </div>
        
        <div class="sobre-contenedor">
          <div class="sobre-fondo"></div>
          
          <div class="solapa-izquierda"></div>
          
          <div class="solapa-derecha"></div>
          
          <div class="sobre-frontal"></div>
          
          <div class="solapa-triangulo"></div>
        </div>
        
      </div>
      
      <button class="btn-abrir-bonito" (click)="abrirSobre()">
        ğŸŒ¸ Abrir InvitaciÃ³n ğŸŒ¸
      </button>
      
    </div>
  </div>

  <div class="invitation-content" *ngIf="sobreAbierto" [@slideIn]>
  <div class="header">
    <div class="decorative-element top"></div>
    <div class="capybara-decorations">
      <img src="assets/capibaras/capybara-flower.png" alt="Capibara" class="capybara-left" *ngIf="false">
      <img src="assets/capibaras/capybara-crown.png" alt="Capibara" class="capybara-right" *ngIf="false">
    </div>
    <div class="capybara-header">ğŸ¦¦ğŸŒ¿</div>
    <h1 class="animate-fade-in">InvitaciÃ³n de Bautizo</h1>
    <div class="hearts">ğŸ¦¦ğŸ’–ğŸŒ¿</div>
  </div>

  <div class="main-content">
    <div class="intro-text animate-slide-up">
      <p class="dear">Querido/a amigo/a:</p>
      <p class="invitation-text">
        Con mucho cariÃ±o te invitamos al bautizo de
      </p>
    </div>

    <div class="name-highlight animate-zoom-in">
      <div class="name-decoration">ğŸ¦¦</div>
      <h2 class="child-name">{{ nombreNina }}</h2>
      <div class="name-decoration">ğŸ¦¦</div>
    </div>
    <div class="capybara-message">
      <div class="cute-capybara capybara-rainbow">ğŸŒˆ</div>
      <p>ğŸŒ¿ Â¡Un dÃ­a especial para celebrar su bautizo! ğŸŒ¿</p>
      <div class="cute-capybara capybara-gift">ğŸ</div>
    </div>

    <div class="slider-container animate-fade-in">
      <div class="slider-wrapper">
        <div class="slider-images" [style.transform]="'translateX(-' + (indiceActual * 100) + '%)'">
          <div class="slide" *ngFor="let imagen of imagenes; let i = index" 
               [class.active]="i === indiceActual"
               [class.prev]="i === indiceActual - 1"
               [class.next]="i === indiceActual + 1">
            <img [src]="imagen" [alt]="'Foto ' + (i + 1)">
          </div>
        </div>
        
        <button class="slider-btn prev" (click)="anterior()" aria-label="Anterior">
          â®
        </button>
        <button class="slider-btn next" (click)="siguiente()" aria-label="Siguiente">
          â¯
        </button>
      </div>
      
      <div class="slider-dots">
        <span 
          *ngFor="let imagen of imagenes; let i = index" 
          class="dot" 
          [class.active]="i === indiceActual"
          (click)="irASlide(i)"
        ></span>
      </div>
    </div>

    <div class="event-date animate-slide-up">
      <p class="date-text">Que se celebrarÃ¡ este</p>
      <p class="date-highlight">{{ fechaBautizo }}</p>
    </div>

    <div class="details-section animate-fade-in">
      <div class="detail-card">
        <div class="capybara-card-icon">ğŸ¦¦ğŸ€</div>
        <div class="icon">â›ª</div>
        <h3>Ceremonia Religiosa</h3>
        <p>ğŸ¦¦ Hora: 10:00 AM</p>
        <p>Iglesia de Ayo Ayo</p>
      </div>

      <div class="detail-card">
        <div class="capybara-card-icon">ğŸ¦¦ğŸ‘‘</div>
        <div class="icon">ğŸ‰</div>
        <h3>CelebraciÃ³n</h3>
        <p>ğŸ¦¦ Hora: 12:00 PM</p>
        <p>ğŸŒ¿ SalÃ³n de Eventos</p>
        <div class="capybara-party">ğŸ¦¦ğŸ§ ğŸ¦¦ğŸ°</div>
      </div>
    </div>

    <div class="mother-section animate-slide-up">
      <p class="with-love">Con mucho cariÃ±o,</p>
      <p class="mother-name">{{ nombreMadre }}</p>
    </div>

    <div class="confirmation-section">
      <div class="capybara-invite">
        <div class="capybara-friend capybara-friend-1">ğŸ¦¦ğŸ’Œ</div>
        <button class="confirm-btn" (click)="toggleFormulario()" *ngIf="!confirmado && !cargando">
          ğŸ¦¦ Confirmar Asistencia ğŸŒ¿
        </button>
        <div class="capybara-friend capybara-friend-2">ğŸ¦¦ğŸˆ</div>
      </div>

      <div class="loading-spinner" *ngIf="cargando">
        <div class="spinner"></div>
        <p>Procesando...</p>
      </div>

      <div class="form-container" *ngIf="mostrarFormulario && !confirmado && !cargando">
        <input 
          type="text" 
          [(ngModel)]="nombreInvitado" 
          placeholder="Tu nombre completo"
          class="input-field"
          (keyup.enter)="confirmarAsistencia()"
        />
        <button class="submit-btn" (click)="confirmarAsistencia()">
          Confirmar ğŸ’–
        </button>
        <p class="error-message" *ngIf="errorMessage">{{ errorMessage }}</p>
      </div>

      <div class="confirmed-message" *ngIf="confirmado">
        <p>âœ… Â¡ConfirmaciÃ³n recibida!</p>
        <p>Â¡Te esperamos! ğŸ’–</p>
        <p class="total-confirmados">Total confirmados: {{ totalInvitados }}</p>
      </div>
    </div>

    <div class="admin-section">
      <button class="admin-toggle-btn" (click)="toggleListaInvitados()">
        {{ autenticado ? 'ğŸ”’ Panel Admin' : 'ğŸ‘€ Ver Lista' }} 
        <span *ngIf="totalInvitados > 0">({{ totalInvitados }})</span>
      </button>

      <div class="admin-login" *ngIf="mostrarLoginAdmin && !autenticado && !cargando">
        <h3>ğŸ” Acceso Administrador</h3>
        <input 
          type="password" 
          [(ngModel)]="passwordAdmin" 
          placeholder="ContraseÃ±a de administrador"
          class="input-field"
          (keyup.enter)="loginAdmin()"
        />
        <button class="submit-btn" (click)="loginAdmin()">
          Entrar
        </button>
        <p class="error-message" *ngIf="errorMessage">{{ errorMessage }}</p>
      </div>

      <div class="guests-list" *ngIf="mostrarListaInvitados && autenticado">
        <div class="admin-header">
          <h3>ğŸ“‹ Invitados Confirmados</h3>
          <button class="logout-btn" (click)="cerrarSesionAdmin()">
            ğŸšª Cerrar SesiÃ³n
          </button>
        </div>
        
        <div class="action-buttons">
          <button class="refresh-btn" (click)="recargarLista()" [disabled]="cargando">
            ğŸ”„ Actualizar
          </button>
          <button class="download-btn" (click)="descargarLista()">
            ğŸ“¥ Descargar Lista
          </button>
          <button class="clear-btn" (click)="limpiarTodo()">
            ğŸ—‘ï¸ Limpiar Todo
          </button>
        </div>
        
        <div class="guest-list-container">
          <div class="guest-item" *ngFor="let invitado of invitadosConfirmados; let i = index">
            <div class="guest-info">
              <span class="guest-number">{{ i + 1 }}.</span>
              <span class="guest-name">{{ invitado.nombre }}</span>
              <span class="guest-date">{{ invitado.fechaLegible }}</span>
            </div>
            <button class="delete-btn" (click)="eliminarInvitado(invitado.id)">
              âŒ
            </button>
          </div>
          
          <div class="empty-message" *ngIf="invitadosConfirmados.length === 0">
            <p>No hay invitados confirmados aÃºn</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    <div class="decorative-element bottom"></div>
    <div class="hearts-bottom">ğŸ¦¦ ğŸŒ¿ ğŸ’• ğŸŒ¿ ğŸ¦¦</div>
  </div>

  <div class="background-hearts">
    <span class="floating-heart" style="left: 10%; animation-delay: 0s;">ğŸ¦¦</span>
    <span class="floating-heart" style="left: 20%; animation-delay: 2s;">ğŸŒ¿</span>
    <span class="floating-heart" style="left: 30%; animation-delay: 4s;">ğŸ’–</span>
    <span class="floating-heart" style="left: 40%; animation-delay: 6s;">ğŸ¦¦</span>
    <span class="floating-heart" style="left: 60%; animation-delay: 1s;">ğŸŒ¿</span>
    <span class="floating-heart" style="left: 70%; animation-delay: 3s;">ğŸ’–</span>
    <span class="floating-heart" style="left: 80%; animation-delay: 5s;">ğŸ¦¦</span>
    <span class="floating-heart" style="left: 90%; animation-delay: 7s;">ğŸŒ¿</span>
  </div>
  </div>
</div>
