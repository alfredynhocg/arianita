<div class="invitation-container" (click)="intentarReproducirMusica()">
  <audio #audioPlayer loop preload="auto">
    <source src="assets/audio/musica.mp3" type="audio/mpeg">
  </audio>
  
  <button class="music-control" (click)="toggleMusic(); $event.stopPropagation()" [title]="musicPlaying ? 'Pausar mÃºsica' : 'Reproducir mÃºsica'">
    {{ musicPlaying ? 'ğŸ”Š' : 'ğŸ”‡' }}
  </button>
  
  <button class="install-btn" *ngIf="mostrarBotonInstalar" (click)="instalarApp(); $event.stopPropagation()" title="Instalar en tu dispositivo">
    ğŸ“± Instalar
  </button>

  <div class="envelope-container" *ngIf="!sobreAbierto">
    <div class="flores-fondo">
      <div class="flor-fondo flor-1">ğŸŒ¸</div>
      <div class="flor-fondo flor-2">ğŸŒº</div>
      <div class="flor-fondo flor-3">ğŸŒ¸</div>
      <div class="flor-fondo flor-4">ğŸŒº</div>
      <div class="flor-fondo flor-5">ğŸŒ¸</div>
      <div class="flor-fondo flor-6">ğŸŒº</div>
      <div class="flor-fondo flor-7">ğŸŒ¸</div>
      <div class="flor-fondo flor-8">ğŸŒº</div>
    </div>
    
    <div class="envelope-scene" style="position:relative;">
      <div class="sobre-titular-centro" style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); text-align:center; z-index:3; width:80%; pointer-events:none;">
        <div class="flor-decorativa" style="font-size:2.2rem;">ğŸŒ¸</div>
        <h2 class="titulo-bautizo" style="margin:0; letter-spacing:2px; font-size:1.3rem; color:#d4508f; text-shadow:0 2px 8px #fff7;">Bautizo de</h2>
        <h1 class="nombre-nina" style="margin:0; font-size:2.8rem; color:#e03a8a; font-family:'Playfair Display',serif; font-weight:700; text-shadow:0 2px 12px #fff8;">Arianita</h1>
        <div class="flores-pequeÃ±as" style="font-size:1.3rem; color:#d4508f; letter-spacing:10px;">âœ¿ â€ âœ¿</div>
      </div>
      <div class="sobre-rosa" (click)="efectoBrilloSobre(); abrirSobre()" style="position:relative;">

<!-- EFECTO DE CORAZONES FLOTANDO -->
<div class="corazones-flotando" *ngIf="mostrarDestello">
  <span *ngFor="let corazon of corazonesAnimados"
        class="corazon-animado"
        [ngClass]="{
          'corazon-brillante': corazon.brillante,
          'corazon-gira': corazon.gira
        }"
        [style.left]="corazon.left"
        [style.fontSize]="corazon.size + 'rem'"
        [style.opacity]="corazon.opacity"
        [style.color]="corazon.color"
        [style.animationDelay]="corazon.delay"
        [style.--desplazamiento-x]="corazon.dx + 'vw'"
        >{{ corazon.icono }}</span>
</div>
        <div class="sobre-contenedor">
          <div class="sobre-fondo"></div>
          <div class="solapa-izquierda"></div>
          <div class="solapa-derecha"></div>
          <div class="sobre-frontal"></div>
          <div class="solapa-triangulo"></div>
        </div>
      </div>
      <button class="btn-abrir-bonito" (click)="efectoBrilloSobre(); abrirSobre()">
        ğŸŒ¸ Abrir InvitaciÃ³n ğŸŒ¸
      </button>
    </div>
  </div>

  <div class="invitation-content" *ngIf="sobreAbierto" [@slideIn]>
  <div class="header modern-header" data-aos="fade-down">
    <div class="header-image-wrapper" style="position: relative; display: inline-block;">
      <span class="header-flower-deco" aria-hidden="true">ğŸŒ¸</span>
    </div>
    <div class="header-content">
      <h1 class="main-title">InvitaciÃ³n al Bautizo</h1>
      <h2 class="main-names">{{ nombreNina }}</h2>
      <div class="header-date-location">
        <span class="header-date">{{ fechaBautizo }}</span>
        <span class="header-location">La Paz, Bolivia</span>
      </div>
    </div>
    <div class="decorative-element top"></div>
  </div>

  <div class="main-content">
    <div class="card-section intro-text animate-slide-up" data-aos="fade-up">
      <p class="dear">Querido/a amigo/a:</p>
      <p class="invitation-text">
        Con mucho cariÃ±o te invitamos al bautizo de
      </p>
    </div>

    <div class="card-section name-highlight animate-zoom-in" data-aos="zoom-in" data-aos-delay="200">
      <div class="name-decoration">ğŸ¦¦</div>
      <h2 class="child-name">{{ nombreNina }}</h2>
      <div class="name-decoration">ğŸ¦¦</div>
    </div>
    <div class="card-section capybara-message" data-aos="fade-up" data-aos-delay="300">
      <div class="cute-capybara capybara-rainbow">ğŸŒˆ</div>
      <p>ğŸŒ¿ Â¡Un dÃ­a especial para celebrar su bautizo! ğŸŒ¿</p>
      <div class="cute-capybara capybara-gift">ğŸ</div>
    </div>

    <div class="card-section slider-container animate-fade-in" data-aos="flip-left" data-aos-duration="1500">
      <div class="slider-wrapper">
        <div class="slider-images" [style.transform]="'translateX(-' + (indiceActual * 100) + '%)'">
          <div class="slide" *ngFor="let imagen of imagenes; let i = index" 
               [class.active]="i === indiceActual"
               [class.prev]="i === indiceActual - 1"
               [class.next]="i === indiceActual + 1">
            <img [src]="imagen" [alt]="'Foto ' + (i + 1)">
          </div>
        </div>
        
        <button class="slider-btn prev" (click)="anterior()" aria-label="Anterior">
          â®
        </button>
        <button class="slider-btn next" (click)="siguiente()" aria-label="Siguiente">
          â¯
        </button>
          <button class="slider-btn prev" (click)="anterior()" aria-label="Imagen anterior" role="button">
            â®
          </button>
          <button class="slider-btn next" (click)="siguiente()" aria-label="Imagen siguiente" role="button">
            â¯
          </button>
      </div>
      
      <div class="slider-dots">
        <span 
          *ngFor="let imagen of imagenes; let i = index" 
          class="dot" 
          [class.active]="i === indiceActual"
          (click)="irASlide(i)"
        ></span>
      </div>
    </div>

    <div class="card-section event-date animate-slide-up" data-aos="fade-up">
      <p class="date-text">Que se celebrarÃ¡ este</p>
      <p class="date-highlight">{{ fechaBautizo }}</p>
    </div>

    <div class="details-section animate-fade-in">
      <div class="detail-card" data-aos="fade-right" data-aos-delay="100">
        <div class="capybara-card-icon">ğŸ¦¦ğŸ€</div>
        <div class="icon">â›ª</div>
        <h3>Ceremonia Religiosa</h3>
        <p>ğŸ¦¦ Hora: 10:00 AM</p>
        <p>Iglesia de Ayo Ayo</p>
      </div>

      <div class="detail-card" data-aos="fade-left" data-aos-delay="200">
        <div class="capybara-card-icon">ğŸ¦¦ğŸ‘‘</div>
        <div class="icon">ğŸ‰</div>
        <h3>CelebraciÃ³n</h3>
        <p>ğŸ¦¦ Hora: 12:00 PM</p>
        <p>ğŸŒ¿ SalÃ³n de Eventos</p>
        <div class="capybara-party">ğŸ¦¦ğŸ§ ğŸ¦¦ğŸ°</div>
      </div>
    </div>

    <div class="mother-section card-section animate-slide-up" data-aos="fade-up" data-aos-delay="100">
      <p class="with-love">Con mucho cariÃ±o,</p>
      <p class="mother-name">{{ nombreMadre }}</p>
    </div>

    <div class="confirmation-section card-section" data-aos="zoom-in" data-aos-delay="200">
      <div class="capybara-invite">
        <div class="capybara-friend capybara-friend-1">ğŸ¦¦ğŸ’Œ</div>
        <button class="confirm-btn" (click)="toggleFormulario()" *ngIf="!confirmado && !cargando">
          ğŸ¦¦ Confirmar Asistencia ğŸŒ¿
        </button>
        <div class="capybara-friend capybara-friend-2">ğŸ¦¦ğŸˆ</div>
      </div>

      <div class="loading-spinner" *ngIf="cargando" data-aos="fade" data-aos-duration="400">
        <div class="spinner"></div>
        <p>Procesando...</p>
      </div>

      <div class="form-container" *ngIf="mostrarFormulario && !confirmado && !cargando" data-aos="fade-up" data-aos-duration="600">
        <input 
          type="text" 
          [(ngModel)]="nombreInvitado" 
          placeholder="Tu nombre completo"
          class="input-field"
          (keyup.enter)="confirmarAsistencia()"
        />
        <button class="submit-btn" (click)="confirmarAsistencia()">
          Confirmar ğŸ’–
        </button>
        <p class="error-message" *ngIf="errorMessage">{{ errorMessage }}</p>
      </div>

      <div class="confirmed-message" *ngIf="confirmado" data-aos="zoom-in" data-aos-duration="800">
        <p>âœ… Â¡ConfirmaciÃ³n recibida!</p>
        <p>Â¡Te esperamos! ğŸ’–</p>
        <p class="total-confirmados">Total confirmados: {{ totalInvitados }}</p>
      </div>
    </div>

    <div class="admin-section" data-aos="fade-up" data-aos-delay="300">
      <button class="admin-toggle-btn" (click)="toggleListaInvitados()">
        {{ autenticado ? 'ğŸ”’ Panel Admin' : 'ğŸ‘€ Ver Lista' }} 
        <span *ngIf="totalInvitados > 0">({{ totalInvitados }})</span>
      </button>

      <div class="admin-login" *ngIf="mostrarLoginAdmin && !autenticado && !cargando" data-aos="flip-down" data-aos-duration="700">
        <h3>ğŸ” Acceso Administrador</h3>
        <input 
          type="password" 
          [(ngModel)]="passwordAdmin" 
          placeholder="ContraseÃ±a de administrador"
          class="input-field"
          (keyup.enter)="loginAdmin()"
        />
          <input 
            type="password" 
            [(ngModel)]="passwordAdmin" 
            placeholder="ContraseÃ±a de administrador"
            class="input-field"
            (keyup.enter)="loginAdmin()"
            aria-label="ContraseÃ±a de administrador"
            required
          />
        <button class="submit-btn" (click)="loginAdmin()">
          Entrar
        </button>
          <button class="submit-btn" (click)="loginAdmin()" aria-label="Entrar como administrador" role="button">
            Entrar
          </button>
        <p class="error-message" *ngIf="errorMessage">{{ errorMessage }}</p>
      </div>

      <div class="guests-list" *ngIf="mostrarListaInvitados && autenticado" data-aos="slide-up" data-aos-duration="800">
        <div class="admin-header">
          <h3>ğŸ“‹ Invitados Confirmados</h3>
          <button class="logout-btn" (click)="cerrarSesionAdmin()">
            ğŸšª Cerrar SesiÃ³n
          </button>
        </div>
        
        <div class="action-buttons">
          <button class="refresh-btn" (click)="recargarLista()" [disabled]="cargando">
            ğŸ”„ Actualizar
          </button>
          <button class="download-btn" (click)="descargarLista()">
            ğŸ“¥ Descargar Lista
          </button>
          <button class="clear-btn" (click)="limpiarTodo()">
            ğŸ—‘ï¸ Limpiar Todo
          </button>
            <button class="refresh-btn" (click)="recargarLista()" [disabled]="cargando" aria-label="Actualizar lista" role="button">
              ğŸ”„ Actualizar
            </button>
            <button class="download-btn" (click)="descargarLista()" aria-label="Descargar lista" role="button">
              ğŸ“¥ Descargar Lista
            </button>
            <button class="clear-btn" (click)="limpiarTodo()" aria-label="Limpiar lista" role="button">
              ğŸ—‘ï¸ Limpiar Todo
            </button>
        </div>
        
        <div class="guest-list-container">
          <div class="guest-item" *ngFor="let invitado of invitadosConfirmados; let i = index">
            <div class="guest-info">
              <span class="guest-number">{{ i + 1 }}.</span>
              <span class="guest-name">{{ invitado.nombre }}</span>
              <span class="guest-date">{{ invitado.fechaLegible }}</span>
            </div>
            <button class="delete-btn" (click)="eliminarInvitado(invitado.id)">
              âŒ
            </button>
              <button class="delete-btn" (click)="eliminarInvitado(invitado.id)" aria-label="Eliminar invitado" role="button">
                âŒ
              </button>
          </div>
          
          <div class="empty-message" *ngIf="invitadosConfirmados.length === 0">
            <p>No hay invitados confirmados aÃºn</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="footer" data-aos="fade-up" data-aos-delay="400">
    <div class="decorative-element bottom"></div>
    <div class="hearts-bottom">ğŸ¦¦ ğŸŒ¿ ğŸ’• ğŸŒ¿ ğŸ¦¦</div>
  </div>

  <div class="background-hearts">
    <span class="floating-heart" style="left: 10%; animation-delay: 0s;">ğŸ¦¦</span>
    <span class="floating-heart" style="left: 20%; animation-delay: 2s;">ğŸŒ¿</span>
    <span class="floating-heart" style="left: 30%; animation-delay: 4s;">ğŸ’–</span>
    <span class="floating-heart" style="left: 40%; animation-delay: 6s;">ğŸ¦¦</span>
    <span class="floating-heart" style="left: 60%; animation-delay: 1s;">ğŸŒ¿</span>
    <span class="floating-heart" style="left: 70%; animation-delay: 3s;">ğŸ’–</span>
    <span class="floating-heart" style="left: 80%; animation-delay: 5s;">ğŸ¦¦</span>
    <span class="floating-heart" style="left: 90%; animation-delay: 7s;">ğŸŒ¿</span>
  </div>
  </div>
</div>
